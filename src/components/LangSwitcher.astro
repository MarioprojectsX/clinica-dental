---
const { locale, currentPath } = Astro.props;

// Path actual sin prefijo /es /ca /en
const rest = (currentPath || "/").replace(/^\/(es|ca|en)/, "") || "/";

function hrefFor(code) {
  if (code === 'es') {
    // SOLO el índice español va en raíz "/"
    if (rest === '/') return '/';
    // En cualquier otra página, ES usa prefijo /es
    return `/es${rest}`;
  }
  // EN/CA siempre con prefijo
  return rest === '/' ? `/${code}` : `/${code}${rest}`;
}

const langs = [
  { code: 'es', label: 'ESP', href: hrefFor('es') },
  { code: 'ca', label: 'CAT', href: hrefFor('ca') },
  { code: 'en', label: 'ENG', href: hrefFor('en') },
];
---

<div class="langswitch">
  {langs.map(({ code, label, href }) => (
    <a
      href={href}
      class={code === locale ? "active" : ""}
      aria-current={code === locale ? "page" : undefined}
    >
      {/* subrayado SOLO en este span */}
      <span class="label">{label}</span>
    </a>
  ))}
</div>

<style>
.langswitch {
  display: flex;
  align-items: baseline; /* alinea todas las siglas por la línea base */
  line-height: 1;
}

/* enlaces base */
.langswitch a,
.langswitch a:link,
.langswitch a:visited {
  color: var(--text-900);
  font-weight: 700;
  text-decoration: none;
  display: inline-flex;
  align-items: baseline; /* misma línea base que el texto */
  line-height: 1;
}

/* guiones (no afectan alineación) */
.langswitch a + a::before {
  content: " - ";
  color: #90a2b5;
  margin: 0 10px;
  display: inline-block;
  line-height: 1;
}

/* texto del idioma */
.langswitch a .label {
  display: inline-block;
  position: relative; /* necesario para colocar el pseudo-elemento debajo */
  line-height: 1;
  padding-bottom: 0;  /* sin padding que altere altura */
  border: 0;
  box-shadow: none;
}

/* subrayado visual controlado con ::after */
.langswitch a.active .label::after,
.langswitch a[aria-current="page"] .label::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  bottom: -3px;                 /* ↓ controla cuánto baja la línea */
  height: 2px;                  /* grosor de la línea */
  background: var(--brand-500); /* color del subrayado */
  border-radius: 1px;           /* suaviza bordes */
}

/* efecto hover sutil */
.langswitch a:hover .label::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  bottom: -3px;
  height: 2px;
  background: rgba(0, 177, 239, 0.3);
  border-radius: 1px;
}


</style>
