---
import BaseLayout from "../layouts/BaseLayout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

const alternates = { es:'/es/', ca:'/ca/', en:'/en/' };
---

<BaseLayout title="Clínica Dental Sueca" description="Odontología integral: estética, ortodoncia e implantes en Barcelona." locale="es" {alternates}>
  <Header locale="es" currentPath="/es/" />

  <!-- ========================= HERO con imagen de fondo ========================= -->
  <section class="hero-landing">
    {/*
      Pre-carga prioritaria real para el héroe (PNG actual).
      Cuando generes AVIF/WebP puedes actualizar src/srcset (ver notas al final).
    */}
    <img
      src="/assets/hero.png"
      alt=""
      aria-hidden="true"
      fetchpriority="high"
      decoding="async"
      style="position:absolute;width:0;height:0;opacity:0"
    />
    <div class="hero__inner container">
      <div class="hero__copy">
        <h1 class="hero__title">
          <img class="hero__mark" src="/assets/mark-hero.svg" alt="" />
          <span>
            Tu mejor sonrisa<br/>
            empieza aquí
          </span>
        </h1>
        <a class="btn btn-hero" href="es/cita">PIDE TU CITA</a>
      </div>
    </div>
  </section>

  <!-- ========================= Bloque: Clínica Dental Sueca ========================= -->
  <section class="section section--about container">
    <div class="about about--compact">
      <div class="about__text">
        <h2 class="about__title">Clínica Dental Sueca</h2>
        <p class="lead">Tu sonrisa, tu mejor carta de presentación.</p>

        <p class="about__confidence">
          En nuestra clínica dental trabajamos para que cada paciente disfrute de una sonrisa sana, estética y natural.
          <span class="hide-mobile">Sabemos que no es solo cuestión de dientes, sino de confianza, bienestar y seguridad personal.</span>
        </p>


        <p>Unimos innovación tecnológica con la experiencia de nuestros especialistas para ofrecerte tratamientos modernos, eficaces y adaptados a ti. Nuestro espacio está diseñado para transmitirte calma y confianza, con un enfoque claro: cuidar de tu salud y realzar tu mejor versión.</p>

        <div class="subtitle">¿Por qué confiar en nosotros?</div>
        <ul class="ul">
          <li>Experiencia sólida de un equipo especializado en todas las áreas de la odontología.</li>
          <li>Tecnología avanzada para resultados predecibles y de alta calidad.</li>
          <li>Atención cercana y personalizada desde el primer día.</li>
        </ul>
      </div>

      <div class="about__img about__img--sm">
        <img src="/assets/about.png" alt="Paciente feliz en clínica dental" loading="lazy" />
      </div>
    </div>
  </section>

  <!-- ========================= Tratamientos ========================= -->
  <section class="treatments container">
    <div class="treatments__mark">
      <img src="/assets/logo-mark.svg" alt="DentLogo" />
    </div>

    <h2 class="treatments__title">Tratamientos dentales</h2>

    <div class="treatments__grid">
      <a href="/es/tratamientos/ortodoncia" class="tr-card">
        <img src="/assets/ortodoncia.svg" alt="Ortodoncia y alineadores" />
        <h3>Ortodoncia y alineadores</h3>
        <p>Alineamos tu sonrisa con tratamientos modernos y discretos...</p>
      </a>

      <a href="/es/tratamientos/implantes" class="tr-card">
        <img src="/assets/implante.svg" alt="" />
        <h3>Implantes dentales</h3>
        <p>Recupera la funcionalidad y estética con implantes de última generación. Resultados duraderos y naturales.</p>
      </a>

      <a href="/es/tratamientos/estetica-dental" class="tr-card">
        <img src="/assets/estetica.svg" alt="" />
        <h3>Estética dental</h3>
        <p>Carillas, blanqueamiento y diseño de sonrisa para mejorar la armonía y luminosidad de tu rostro.</p>
      </a>

      <a href="/es/tratamientos/rehabilitacion-oral" class="tr-card">
        <img src="/assets/rehabilitacion.svg" alt="" />
        <h3>Rehabilitación oral</h3>
        <p>Tratamiento integral que combina prótesis, implantes y técnicas para devolver la funcionalidad.</p>
      </a>

      <a href="/es/tratamientos/endodoncia" class="tr-card">
        <img src="/assets/endodoncia.svg" alt="" />
        <h3>Endodoncia</h3>
        <p>Salvamos dientes dañados o infectados, eliminando el dolor y evitando su extracción.</p>
      </a>

      <a href="/es/tratamientos/odontopediatria" class="tr-card">
        <img src="/assets/odontopediatria.svg" alt="" />
        <h3>Odontopediatría</h3>
        <p>Cuidamos la sonrisa infantil con prevención, control de hábitos y ortodoncia temprana.</p>
      </a>
    </div>
  </section>

  <!-- ========================= CTA consulta gratis ========================= -->
  <section class="cta-strip">
    <div class="cta-strip__inner container">
      <img class="cta-strip__mark" src="/assets/mark-hero.svg" alt="DentLogo" />
      <h2 class="cta-strip__title">Primera consulta y diagnóstico gratuito</h2>
      <a class="btn btn-cta" href="/es/cita" aria-label="Agendar tu cita">
        AGENDA TU CITA
      </a>
    </div>
  </section>

  <!-- ================== INSTALACIONES ================== -->
  <section class="facilities container">
    <h2 class="section-title">Instalaciones</h2>

    <div class="facilities__grid">
      <figure class="facility">
        <img src="/assets/instalaciones/inst1.png" alt="inst1" />
      </figure>
      <figure class="facility">
        <img src="/assets/instalaciones/inst2.png" alt="inst2" />
      </figure>
      <figure class="facility">
        <img src="/assets/instalaciones/inst3.png" alt="inst3" />
      </figure>
      <figure class="facility">
        <img src="/assets/instalaciones/inst4.png" alt="inst4" />
      </figure>
      <figure class="facility">
        <img src="/assets/instalaciones/inst5.png" alt="inst5" />
      </figure>
      <figure class="facility">
        <img src="/assets/instalaciones/inst6.png" alt="inst6" />
      </figure>
    </div>
  </section>

  <!-- ========== RESEÑAS: ¿Qué opinan nuestros pacientes? ========== -->
  <section class="reviews container">
    <h2 class="section-title">¿Qué opinan nuestros pacientes?</h2>

    <div class="reviews__grid">
      <!-- Card 1 -->
      <article class="r-card">
        <header class="r-card__head">
          <div class="r-author">
            <img class="r-avatar" src="/assets/persona1.png" alt="Norma Miryam" />
            <div>
              <h3 class="r-name">Norma Miryam Felic...</h3>
              <div class="r-date">03/06/2025</div>
            </div>
          </div>
          <img class="r-g" src="/assets/icons/logo-google.svg" alt="Google" />
        </header>

        <div class="r-stars" aria-label="5 de 5">
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <span class="r-verified" title="Opinión verificada" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M12 2l2.4 2.4 3.4-.7-.7 3.4L20 9.6l-2.9.6-.6 2.9-2.9.6-.6 2.9L9.6 20l.6-2.9-2.9-.6-.6-2.9L4 9.6l2.9-.6.6-2.9L12 2z"/></svg>
            <img src="/assets/icons/check-azul.png" alt="verificado" width="18" height="18">
          </span>
        </div>

        <p class="r-text">Trato y profesionales inmejorables!</p>
      </article>

      <!-- Card 2 -->
      <article class="r-card">
        <header class="r-card__head">
          <div class="r-author">
            <img class="r-avatar" src="/assets/persona2.png" alt="Maria Molle" />
            <div>
              <h3 class="r-name">Maria Molle</h3>
              <div class="r-date">03/06/2025</div>
            </div>
          </div>
          <img class="r-g" src="/assets/icons/logo-google.svg" alt="Google" />
        </header>
        <div class="r-stars" aria-label="5 de 5">
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <img src="/assets/icons/check-azul.png" alt="verificado" width="18" height="18">
        </div>
        <p class="r-text">¡Mi clínica de confianza, no la cambio por ninguna otra!!!</p>
      </article>

      <!-- Card 3 -->
      <article class="r-card">
        <header class="r-card__head">
          <div class="r-author">
            <div class="r-avatar r-avatar--initial">A</div>
            <div>
              <h3 class="r-name">Aleix Masip</h3>
              <div class="r-date">03/06/2025</div>
            </div>
          </div>
          <img class="r-g" src="/assets/icons/logo-google.svg" alt="Google" />
        </header>
        <div class="r-stars" aria-label="5 de 5">
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <img src="/assets/icons/check-azul.png" alt="verificado" width="18" height="18">
        </div>
        <p class="r-text">¡Muy amables!</p>
      </article>

      <!-- Card 4 -->
      <article class="r-card">
        <header class="r-card__head">
          <div class="r-author">
            <img class="r-avatar" src="/assets/persona3.png" alt="Judit Garcia" />
            <div>
              <h3 class="r-name">Judit Garcia Santa...</h3>
              <div class="r-date">03/06/2025</div>
            </div>
          </div>
          <img class="r-g" src="/assets/icons/logo-google.svg" alt="Google" />
        </header>
        <div class="r-stars" aria-label="5 de 5">
          <svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg><svg class="star" viewBox="0 0 24 24"><path d="M12 17.3l-6.12 3.22 1.17-6.83-4.95-4.82 6.84-.99L12 .8l3.06 6.18 6.84.99-4.95 4.82 1.17 6.83z"/></svg>
          <img src="/assets/icons/check-azul.png" alt="verificado" width="18" height="18">
        </div>
        <p class="r-text">Súper contenta con el trato recibido, súper amables y muy profesionales!!!</p>
      </article>
    </div>

    <div class="reviews__badge">
      <span>Verificado por: Trustindex
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="16" height="16">
          <circle cx="128" cy="128" r="100" stroke="currentColor" stroke-width="22" fill="none"/>
          <rect x="120" y="112" width="16" height="72" rx="4" fill="currentColor"/>
          <circle cx="128" cy="88" r="10" fill="currentColor"/>
        </svg>
      </span>
    </div>
  </section>
<!-- ========== UBICACIÓN / MAPA (FULL-BLEED) ========== -->
<section class="location location--fullbleed">
  <div class="location__stage">
    <!-- Placeholder ligero (imagen estática del mapa) -->
    <button class="location__placeholder" id="mapLoader" type="button"
      aria-label="Cargar mapa interactivo">
      <img
        src="/assets/mapa-placeholder.png"
        alt="Mapa de la zona de la clínica (pulsa para cargar el mapa)"
        loading="lazy"
        decoding="async"
      />
    </button>

    <!-- Aquí se inyecta el iframe cuando el usuario hace clic o entra al viewport -->
    <div id="mapMount" class="location__mount" hidden></div>

    <!-- Tarjeta info: se superpone en desktop y cae debajo en mobile -->
    <aside class="location__card" data-hidden="true">
      <h3>Encuéntranos en:</h3>
      <p>
        C. de Muntaner 555, Esc. A, Planta 3 - 2,<br>
        Sarrià-Sant Gervasi, Barcelona.<br>
        <a href="tel:+34603239015">+34 603 23 90 15</a><br><br>
        Lunes a viernes<br>
        10:00 a 14:00 y 16:00 a 20:00
      </p>
      <a class="location__btn"
        target="_blank"
        href="https://www.google.com/maps/dir/?api=1&destination=41.4050801,2.1352314">
        Cómo llegar
      </a>
    </aside>
  </div>
</section>


  <!-- ========== BLOG (INICIO) ========== -->
  <section class="blog container" aria-labelledby="blog-title">
    <h2 id="blog-title" class="section-title">Blog</h2>

    <div class="blog__grid">
      <!-- Post 1 -->
      <article class="b-card">
        <a class="b-card__media" href="#">
          <img src="/assets/blog/blog-img1.png" alt="Equipo odontológico atendiendo a una paciente" loading="lazy">
        </a>
        <div class="b-card__body">
          <h3 class="b-card__title">
            <a href="#">
              ¿Duele la ortodoncia? Lo que debes saber antes de empezar tu tratamiento
            </a>
          </h3>
          <p class="b-card__excerpt">La ortodoncia es uno de los tratamientos más comunes. Te contamos qué esperar…</p>
          <a class="b-card__link" href="#">Leer más</a>
        </div>
      </article>

      <!-- Post 2 -->
      <article class="b-card">
        <a class="b-card__media" href="#">
          <img src="/assets/blog/blog-img2.png" alt="Demostración con prótesis dental y sonda" loading="lazy">
        </a>
        <div class="b-card__body">
          <h3 class="b-card__title">
            <a href="#">
              Sialorrea o Hipersalivación: qué es, causas, síntomas y tratamiento
            </a>
          </h3>
          <p class="b-card__excerpt">Sabemos lo complicado que puede ser el exceso de saliva. Repasamos causas y opciones…</p>
          <a class="b-card__link" href="#">Leer más</a>
        </div>
      </article>

      <!-- Post 3 -->
      <article class="b-card">
        <a class="b-card__media" href="#">
          <img src="/assets/blog/blog-img3.png" alt="Paciente revisando su sonrisa con espejo" loading="lazy">
        </a>
        <div class="b-card__body">
          <h3 class="b-card__title">
            <a href="#">
              Invisalign: limpieza y mantenimiento de los alineadores
            </a>
          </h3>
          <p class="b-card__excerpt">Para un mejor funcionamiento, te contamos cómo limpiar y cuidar tus alineadores…</p>
          <a class="b-card__link" href="#">Leer más</a>
        </div>
      </article>
    </div>
  </section>

  <Footer locale="es" />
</BaseLayout>

<!-- ========================= ESTILOS LOCALES (HÉROE + MAPA) ========================= -->
<style>
  /* HERO: dimensiones y fondo */
  .hero-landing {
    min-height: clamp(420px, 60vh, 760px);
    display: grid;
    place-items: center;
    position: relative;

    /* Por ahora SOLO PNG (para evitar 404 si aún no generas AVIF/WebP) */
    background-image: image-set(
      url("/assets/hero.png") type("image/png")
    );
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;

    contain: paint;
  }

</style>

<script is:inline>
  // --- Elementos
  const btn   = document.getElementById('mapLoader');
  const mount = document.getElementById('mapMount');
  const CARD  = document.querySelector('.location__card');

  // --- Constantes
  const SRC = "https://www.google.com/maps?q=41.4050801,2.1352314&z=15&output=embed";
  const CONSENT_KEY = "cookieConsent";

  // --- Helpers
  function getConsent(){
    try { return JSON.parse(localStorage.getItem(CONSENT_KEY) || "null"); }
    catch { return null; }
  }
  function hasAccepted(){ return getConsent()?.status === "accepted"; }

  function showCard(){ CARD?.removeAttribute('data-hidden'); }

  function loadMap(){
    if (!mount || mount.dataset.loaded) return;
    mount.dataset.loaded = "1";
    const iframe = document.createElement('iframe');
    iframe.className = "location__map";
    iframe.loading = "lazy";
    iframe.allowFullscreen = true;
    iframe.referrerPolicy = "no-referrer-when-downgrade";
    iframe.src = SRC;
    mount.appendChild(iframe);
    mount.hidden = false;
    btn?.remove();
  }

  // Estado inicial de la tarjeta (si ya había aceptado antes)
  if (hasAccepted()) showCard();

  // Al aceptar desde el banner (evento emitido desde BaseLayout)
  window.addEventListener('cookie:accepted', () => {
    showCard();
    // el IO de abajo auto-cargará si ya está en viewport
  });

  // ✅ Clic en placeholder: SIEMPRE mostrar tarjeta y cargar mapa
  //    (sin abrir el banner, aunque no haya consentimiento global)
  btn?.addEventListener('click', () => {
    showCard();
    loadMap();
  });

  // Auto-carga por viewport: SOLO si hay consentimiento previo (prudencia)
  const section = document.querySelector('.location');
  if (section) {
    const io = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting && hasAccepted()) {
          loadMap();
          io.disconnect();
        }
      });
    }, { rootMargin: "200px" });
    io.observe(section);
  }
</script>


